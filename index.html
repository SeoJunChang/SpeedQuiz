<body>
    <div class="app">
        <header>
            <div id="qCount">카테고리를 골라주세요</div>
            <div>점수: <span id="score">0</span></div>
        </header>
        <div class="progress-container"><div id="timerBar" class="timer-bar" style="width:0%"></div></div>
        
        <div id="startScreen" class="game-card">
            <h2 style="margin-bottom:20px">어떤 퀴즈에 도전할까요?</h2>
            <div id="categoryButtons" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; width:100%">
                </div>
        </div>

        <div id="gameScreen" class="game-card" style="display:none">
            <div id="catBadge" class="cat-badge">카테고리</div>
            <div id="question" class="question">문제가 로드 중입니다...</div>
            <input type="text" id="answerInput" class="answer-input" placeholder="정답 입력" autocomplete="off">
            <div id="hint" style="margin-top:20px; font-size:14px; color:var(--gold)"></div>
        </div>
    </div>

    ...

    <script>
        let allData = [];
        let gameItems = [];
        let selectedCategory = "";
        // ... (기존 변수 유지)

        async function loadData() {
            try {
                const response = await fetch('./words.json');
                const json = await response.json();
                allData = json.data;
                showCategorySelection(json.categories);
            } catch (e) {
                document.getElementById('question').textContent = "데이터 로드 실패";
            }
        }

        // 1. 카테고리 버튼 생성
        function showCategorySelection(categories) {
            const btnContainer = document.getElementById('categoryButtons');
            btnContainer.innerHTML = ''; // 초기화
            
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.style.marginTop = '0';
                btn.textContent = cat;
                btn.onclick = () => startGameWithCategory(cat);
                btnContainer.appendChild(btn);
            });
        }

        // 2. 선택된 카테고리로 게임 시작
        function startGameWithCategory(cat) {
            selectedCategory = cat;
            // 해당 카테고리 문제만 필터링 후 12개 무작위 추출
            const filtered = allData.filter(d => d.cat === cat);
            gameItems = filtered.sort(() => Math.random() - 0.5).slice(0, 12);
            
            // 화면 전환
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'flex';
            
            startQuest();
        }

        // ... (startQuest, processCorrect 등 나머지 로직은 기존과 동일)
    </script>
</body>
